from prefect import flow, task
import subprocess
import sys

@task
def run_train():
    print("ğŸ§  Training model...", flush=True)
    result = subprocess.run(["python3", "../../train.py"])
    if result.returncode != 0:
        raise RuntimeError("âŒ Training failed")
    print("âœ… Model training completed", flush=True)

@flow(name="Weekly Training")
def train_flow():
    run_train()