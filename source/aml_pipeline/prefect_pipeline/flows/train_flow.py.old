from prefect import flow, task
import subprocess
import sys

@task
def run_train():
    print("🧠 Training model...", flush=True)
    result = subprocess.run(["python3", "../../train.py"])
    if result.returncode != 0:
        raise RuntimeError("❌ Training failed")
    print("✅ Model training completed", flush=True)

@flow(name="Weekly Training")
def train_flow():
    run_train()