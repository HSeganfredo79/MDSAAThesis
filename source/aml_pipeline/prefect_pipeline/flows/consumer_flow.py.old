from prefect import flow, task
import subprocess
import sys

@task
def run_consumer():
    print("ðŸ”„ Starting Kafka Consumer...", flush=True)
    subprocess.Popen(["python3", "../../kafka_consumer.py"])
    print("âœ… Kafka Consumer running in background.", flush=True)

@flow(name="Kafka Consumer Flow")
def consumer_flow():
    run_consumer()