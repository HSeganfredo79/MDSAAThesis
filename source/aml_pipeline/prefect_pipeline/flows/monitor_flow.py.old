from prefect import flow, task
import subprocess
import sys

@task
def run_monitor():
    print("ğŸ§ª Running drift monitor...", flush=True)
    result = subprocess.run(["python3", "../../monitor.py"])
    if result.returncode != 0:
        raise RuntimeError("âŒ Drift monitor failed")
    print("âœ… Drift monitor completed", flush=True)

@flow(name="Drift Monitor")
def monitor_flow():
    run_monitor()